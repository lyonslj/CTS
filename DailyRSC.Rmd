---
output: html_document
fig_width: 23
fig.align: "center"

---

<style type="text/css">
.main-container {
  max-width: 1800px;
  margin-left: auto;
  margin-right: auto;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


library(TTR)
library(quantmod)
library(reshape2)
library(plyr)
library(dplyr)
library(tidyr)
library(readxl)
library(reshape2)
library(DT)
library(plotly)
library(dygraphs)
library(data.table)
library(TTR)


source('~/Documents/Personal/DataScience/R/JL CTS scripts/DailyGraphNoPng.R')
source('~/Documents/Personal/DataScience/R/JL CTS scripts/WeeklyGraph.R')
source('~/Documents/Personal/DataScience/R/JL CTS scripts/RscHeatmap.R')
source('~/Documents/Personal/DataScience/R/JL CTS scripts/RelativeStrengthComparative.R')
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/PLv2.R")
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/CumRet.R")
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/CumRetDyG.R")
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/fnDyCumRet.R")
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/fnLists.R")
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/fnDyGraph.R")
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/fnOpportunities.R")
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/RelativeStrengthComparativeAllSegments.R")
source("/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/fnAboveMA.R")



##  ---------Previously Loaded data ---------

if (exists("JSEdat")) {
        message("JSEdat data is already in the environment. No action taken.")
} else {
        # After loading, perform the date conversion.
        JSEloaded_dat <- read.csv("/Users/johnlyons/Documents/Personal/DataScience/R/JSEdat.csv", header = TRUE, sep="")
        ## -- Convert to correct format
        JSEloaded <- JSEloaded_dat
        JSEloaded$Date <- as.Date(JSEloaded$Date, "%Y-%m-%d")
        message("JSEloaded data was not found and has been loaded.")
        JSEdat <- JSEloaded
        JSE.recent.dat <- JSEdat[JSEdat$Date >= Sys.Date()-450,]
        JSE.recent.dat <- unique(JSE.recent.dat[complete.cases(JSE.recent.dat),])
        cols <- 3:7
        JSE.recent.dat[, cols] <- apply(JSE.recent.dat[, cols], 2, as.numeric)
}
        
        
        ## -- Check for last loaded date
        max(sort(JSEloaded$Date))
        
           # ----------- All lists of Indexes and data -------------------
        lists <- fnLists()
        excl_list <- lists$excl_list
        Indexes <- lists$Indexes

        list.of.i <- NULL
        df.daily.roc <- NULL
        df.weekly.roc <- NULL
        df.monthly.roc <- NULL




```

## Market Analysis  {.tabset .tabset-fade .tabset-pills}



### Zar

```{r, fig.width=14,  fig.height= 8, message= FALSE, warning=FALSE, echo = FALSE, silent = TRUE}   

lst <- lists$zar
RSC(lst,"Zar","Weekly",to_console = FALSE)
to_graph_zar  <- to_graph
fnDyCumRet(to_graph_zar,"",30)                          # ---- Graph the top 20 from the heatmap

fnDyGraph(to_graph_zar)                             # ---- Graph the top 20 from the heatmap

```
### Indexes

```{r, fig.width=14,  fig.height= 8, message= FALSE, warning=FALSE, echo = FALSE, silent = TRUE}   


lst <- lists$Indexes
dflst <- filter(JSEdat, JSEdat$Name %in% lst) %>% arrange(Date)
RSC(lst,"Indexes","Weekly",to_console = FALSE)  # generate rsc heatmap
fnAboveMA(dflst)                                # generate heatmap of inst above 21 and 50 dma
to_graph_ind <- to_graph
fnDyCumRet(to_graph_ind,"",20)
fnDyGraph(to_graph_ind)                            # ---- Graph the top 20 from the heatmap

```

### Currencies

```{r, fig.width=14,  fig.height= 8, message= FALSE, warning=FALSE, echo = FALSE, silent = TRUE}   

lst <- lists$CURR
RSC(lst,"Currencies","Weekly",to_console = FALSE)
fnDyCumRet(to_graph,"",30)
                         # ---- Graph the top 20 from the heatmap
dflst <- filter(JSEdat, JSEdat$Name %in% lst) %>% arrange(Date)
fnAboveMA(dflst)                                # generate heatmap of inst above 21 and 50 dma

fnDyGraph(to_graph)     # ---- Graph the top 20 from the heatmap

```

### TopList

```{r, fig.width=14,  fig.height= 8, message= FALSE, warning=FALSE, echo = FALSE, silent = TRUE}   

jl <- unique(c(lists$RESI, "BATS", lists$CHES, lists$TECH, "GOLD-R",  lists$GOLD, "SILV-R", "PLAT-R","C-ETHZAR","C-BTCZAR"))
RSC(jl,"TopList","Daily",to_console = FALSE)
to_graph_top <- to_graph
fnDyCumRet(to_graph_top,"",30)
                       # ---- Graph the top 20 from the heatmap
fnDyGraph(to_graph_top)                             # ---- Graph the top 20 from the heatmap

```
### Commods

```{r, fig.width=14,  fig.height= 8, message= FALSE, warning=FALSE, echo = FALSE, silent = TRUE}   
lst <- lists$Commods
#RSC(lst,"Commods","Weekly",to_console = FALSE)
fnDyCumRet(lst,"",20)
                       # ---- Graph the top 20 from the heatmap
fnDyGraph(lst)                             # ---- Graph the top 20 from the heatmap

```
### Satrix

```{r, fig.width=14,  fig.height= 8, message= FALSE, warning=FALSE, echo = FALSE, silent = TRUE}   
sat <- unique(JSEdat[grep(c("SATRIX"),JSEdat$Name),1])    
RSC(sat,"Satrix","Daily",to_console = FALSE)

```
### Opportunities

```{r, fig.width=14,  fig.height= 8, message= FALSE, warning=FALSE, echo = FALSE, silent = TRUE}   

fnOppo()                          # ---- Brekouts
fnDyGraph(oppo_instruments)
```

### Trading Plan

* Your trading objective is to make money, not to lose it. The losses kill you
* Thats how you make money and not compromise your capital
* Trade mechanically - Follow The Rules
* The key is not where to Enter, but where to Exit
* Trade according to RSC heatmap
* Exit
+ Close below 4hr Kaufman Adaptive MA
+ and / or confirmed by RSC heatmap change
* Do not chase gains if these two conditions have been vioalted - FTR

##### All neg R > -1 except 2

![Alt text](/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/Bad1.png)![Alt text](/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/Bad2.gif)

![Alt text](/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/Bad3.gif)![Alt text](/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/Bad4.gif)

![Alt text](/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/Bad5.gif)![Alt text](/Users/johnlyons/Documents/Personal/DataScience/R/JL CTS scripts/Bad6.gif)

